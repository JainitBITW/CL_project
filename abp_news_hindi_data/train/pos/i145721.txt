शिवाजी को आगरा बुलाया गया जहाँ उन्हें लगा कि उन्हें उचित सम्मान नहीं मिल रहा है। इसके ख़िलाफ़ उन्होंने अपना रोश भरे दरबार में दिखाया और औरंगजेब पर विश्वासघात का आरोप लगाया। औरंगजेब इससे क्षुब्ध हुआ और उसने शिवाजी को नज़रकैद कर दिया और उनपर 5000 सैनिकों के पहरे लगा दिये। कुछ ही दिनों बाद राजा शिवाजी को मार डालने का इरादा औरंगजेब का था। लेकिन अपने अजोड साहस ओर युक्ति के साथ शिवाजी और सम्भाजी दोनों इससे भागने में सफल रहे। सम्भाजी को मथुरा में एक विश्वासी ब्राह्मण के यहाँ छोड़ शिवाजी महाराज बनारस, गये, पुरी होते हुए सकुशल राजगढ़ पहुँच गए । इससे मराठों को नवजीवन सा मिल गया। औरंगजेब ने जयसिंह पर शक करके उसकी हत्या विष देकर करवा डाली। जसवंत सिंह के द्वारा पहल करने के बाद सन् 1668 में शिवाजी ने मुगलों के साथ दूसरी बार सन्धि की। औरंगजेब ने शिवाजी को राजा की मान्यता दी। शिवाजी के पुत्र शम्भाजी को 5000 की मनसबदारी मिली और शिवाजी को पूना, चाकन और सूपा का जिला लौटा दिया गया। पर, सिंहगढ़ और पुरन्दर पर मुग़लों का अधिपत्य बना रहा। सन् 1670 में सूरत नगर को दूसरी बार शिवाजी ने लूटा। नगर से 132 लाख की सम्पत्ति शिवाजी के हाथ लगी और लौटते वक्त उन्होंने मुगल सेना को सूरत के पास फिर से हराया।