दोस्त मोहम्मद खान ने स्थानीय अर्धशिक्षित लोगों से भरी, 18 भारी बंदूकों से लैस 25,000 की सेना भेजा। वहाँ सिख चौकी में केवल 600 लोग और कुछ छोटे तोपखाने थे। एक टुकड़ी शबकदर के पड़ोसी सिख किले को भेजा गया था, उस दिशा से कोई मदद को रोकने के लिए। किले को घेर लिया और उसके पानी की आपूर्ति काट दिया। महा सिंह, जमरूद की चौकी कमांडर, चार दिनों के लिए आक्रमणकारियों को रोक रखा और पेशावर में हरि सिंह को मदद के लिए एक हताश अपील भेजने में कामयाब रहे। नलवा अपने बीमार बिस्तर से गुलाब और जमरूद के लिए रवाना हो गया।